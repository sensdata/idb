table inet idb-filter {
    
    # 定义 input 链（控制进入本机的流量）
    chain input {
        type filter hook input priority 0; policy drop;

        iif lo accept
        iif docker0 accept
        iif docker_gwbridge accept
        iifname "br-+" accept
        iifname "veth+" accept

        ct state established,related accept

        tcp dport 22 accept
        tcp dport 9918 accept
        tcp dport 9919 accept

        icmp type echo-request drop
    }

    # 定义 output 链（控制本机发出的流量）
    chain output {
        type filter hook output priority 0; policy accept;
    }

    # 定义 forward 链（转发流量，适用于路由器等设备）， 默认放行，避免影响docker
    chain forward {
        type filter hook forward priority 0; policy accept;
    }
}
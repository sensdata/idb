# 声明表，选择协议族（例如：ip 表）
table ip idb-filter {
    
    # 定义 input 链（控制进入本机的流量）
    chain input {
        type filter hook input priority 10; policy drop;

        # 禁止 ping（丢弃 ICMP echo 请求）
        icmp type echo-request drop

        # 允许本地回环接口的流量
        iifname "lo" accept

        # 放行已建立和相关连接（避免响应包被拦）
        ct state established,related accept

        # 允许 SSH, Center 和 Agent 的通信端口
        tcp dport 22 accept
        tcp dport 9918 accept
        tcp dport 9919 accept
    }

    # 定义 output 链（控制本机发出的流量）
    chain output {
        type filter hook output priority 10; policy accept; 
    }

    # 定义 forward 链（转发流量，适用于路由器等设备）
    chain forward {
        type filter hook forward priority 10; policy drop; 
    }
}
